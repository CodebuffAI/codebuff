{
  "description": "Template configuration for this project. See https://www.codebuff.com/config for all options.",
  "startupProcesses": [
    {
      "name": "drizzle",
      "command": "bun start-studio",
      "stdoutFile": "debug/drizzle.log"
    },
    {
      "name": "web-server",
      "command": "bun start-web",
      "stdoutFile": "debug/web.log"
    }
  ],
  "fileChangeHooks": [
    {
      "name": "backend-unit-tests",
      "command": "set -o pipefail && find src -name '*.test.ts' ! -name '*.integration.test.ts' | sort | xargs -I {} ../.bin/bun test {} 2>&1 | grep -Ev '✓|\\(pass\\)'",
      "cwd": "backend",
      "filePattern": "backend/**/*.ts"
    },
    {
      "name": "backend-typecheck",
      "command": "bun run typecheck",
      "cwd": "backend",
      "filePattern": "backend/**/*.ts"
    },
    {
      "name": "npm-app-unit-tests",
      "command": "set -o pipefail && find src -name '*.test.ts' ! -name '*.integration.test.ts' | sort | xargs -I {} ../.bin/bun test {} 2>&1 | grep -Ev '✓|\\(pass\\)'",
      "cwd": "npm-app",
      "filePattern": "npm-app/**/*.ts"
    },
    {
      "name": "npm-typecheck",
      "command": "bun run typecheck",
      "cwd": "npm-app",
      "filePattern": "npm-app/**/*.ts"
    },
    {
      "name": "web-typecheck",
      "command": "bun run typecheck",
      "cwd": "web",
      "filePattern": "web/**/*.ts*"
    },
    {
      "name": "common-unit-tests",
      "command": "set -o pipefail && find src -name '*.test.ts' ! -name '*.integration.test.ts' | sort | xargs -I {} ../.bin/bun test {} 2>&1 | grep -Ev '✓|\\(pass\\)'",
      "cwd": "common",
      "filePattern": "common/**/*.ts"
    },
    {
      "name": "common-typecheck",
      "command": "bun run typecheck",
      "cwd": "common",
      "filePattern": "common/**/*.ts"
    },
    {
      "name": "prettier-format",
      "command": "git diff --name-only --diff-filter=ACMR | grep -E '\\.(ts|tsx|json|md)$' | xargs -r npx prettier --write",
      "filePattern": "**/*.{ts,tsx,json,md}"
    }
  ],
  "maxAgentSteps": 20
}
