---
title: 'Agent Reference'
section: 'advanced'
tags: ['customization', 'agent templates', 'agents', 'reference']
order: 4
---

# Agent Reference

Complete reference for all agent configuration fields and tools.

## Key Terms

**Agent Template:** JSON file defining agent behavior
**Spawnable Agents:** Sub-agents this agent can create
**Tool Names:** Capabilities (read files, run commands, etc.)
**Output Mode:** Response format (last message, report, all messages)
**Prompt Schema:** Input validation rules

## Agent Configuration

When creating agent templates, you define all aspects of the agent from scratch.

### Agent Schema

<AgentTemplateSchemaDisplay />

### Model Configuration

#### `model` (string, required)

The model to use, which can be any model string from  [Openrouter](https://openrouter.ai/models).

```json
"model": "anthropic/claude-4-sonnet-20250522"
```

### Behavior Configuration

#### `outputMode` (string, optional, default: "last_message")

How the agent's output is handled.

**Options:**

- `"last_message"` - Return only the final message
- `"report"` - Return a structured report
- `"all_messages"` - Return all messages from the conversation

```json
"outputMode": "last_message"
```

#### `includeMessageHistory` (boolean, optional, default: true)

Whether to include conversation history when spawning this agent.

```json
"includeMessageHistory": true
```

### Tools and Capabilities

#### `toolNames` (array, optional, default: ["end_turn"])

List of tools the agent can use.

**Available Tools:**

- `add_subgoal` - Create subgoals for tracking progress
- `browser_logs` - Navigate web pages and get console logs
- `code_search` - Search for patterns in code files
- `create_plan` - Generate detailed plans for complex tasks
- `end_turn` - End the agent's turn
- `find_files` - Find relevant files in the codebase
- `read_docs` - Read documentation for libraries
- `read_files` - Read file contents
- `run_file_change_hooks` - Run configured file change hooks
- `run_terminal_command` - Execute terminal commands
- `spawn_agents` - Spawn other agents
- `str_replace` - Replace strings in files
- `think_deeply` - Perform deep analysis
- `update_subgoal` - Update existing subgoals
- `web_search` - Search the web
- `write_file` - Create or edit files
- `set_output` - Set an output JSON object

```json
"toolNames": ["read_files", "write_file", "code_search", "end_turn"]
```

#### `spawnableAgents` (array, optional, default: [])

Other agents this agent can spawn.

**Available Built-in Agents:**

- `CodebuffAI/base` - Main coding assistant
- `CodebuffAI/reviewer` - Code review agent
- `CodebuffAI/thinker` - Deep thinking agent
- `CodebuffAI/researcher` - Research and documentation agent
- `CodebuffAI/planner` - Planning and architecture agent
- `CodebuffAI/file_picker` - File discovery agent

```json
"spawnableAgents": ["CodebuffAI/researcher", "CodebuffAI/reviewer"]
```

### Prompt Configuration

All prompt fields support two formats:

1. **Direct string content:**

```json
"systemPrompt": "You are a helpful assistant..."
```

2. **External file reference:**

```json
"systemPrompt": {
  "path": "./my-system-prompt.md"
}
```

#### Required Prompts

#### `systemPrompt` (string or object, required)

Core instructions that define the agent's behavior and personality.

#### `userInputPrompt` (string or object, required)

Instructions for how to process user input.

#### `agentStepPrompt` (string or object, required)

Instructions for each step of the agent's execution.



### Schema Validation

#### `promptSchema` (object, optional)

JSON Schema definitions for validating prompt and params when spawning the agent.

```json
"promptSchema": {
  "prompt": {
    "type": "string",
    "description": "What documentation to create"
  },
  "params": {
    "type": "object",
    "properties": {
      "format": {
        "type": "string",
        "enum": ["markdown", "html"]
      }
    }
  }
}
```

### Parent Instructions

#### `parentInstructions` (object, optional)

Defines instructions that this agent provides to other agents when they are spawned. This allows agents to guide the behavior of their sub-agents without creating full overrides.

**How it works:**
- When an agent spawns another agent, the system looks for any `parentInstructions` targeting that agent type
- These instructions are automatically injected into the spawned agent's `userInputPrompt`
- Multiple agents can provide instructions for the same target agent - all will be included

**Structure:**
```json
"parentInstructions": {
  "researcher": "Instruction text for researcher to know when to spawn your agent",
  "another-agent": "Different instruction for another-agent to know when to spawn your agent"
}
```

**When to use:**
- **Conditional guidance**: Provide context-specific instructions based on the spawning scenario
- **Workflow coordination**: Ensure spawned agents follow specific patterns or requirements
- **Domain expertise**: Share specialized knowledge with relevant sub-agents
- **Quality control**: Add validation or review requirements for specific agent types

**Validation:**
- Agent types in `parentInstructions` must be valid (either built-in or custom agents)
- Invalid agent types will cause validation errors during agent loading

**Best practices:**
- Keep instructions concise and actionable
- Focus on behavior modifications rather than complete workflow changes
- Test instructions with different spawning scenarios
- Consider the cumulative effect when multiple agents provide instructions for the same target
- Remember that `parentInstructions` can only be defined in new agent templates, not in override files

### Agent Example

```json
{
  "id": "documentation-writer",
  "version": "1.0.0",
  "override": false,

  "name": "Documentation Writer",
  "purpose": "Specialized agent for creating comprehensive documentation",
  "model": "anthropic/claude-4-sonnet-20250522",
  "outputMode": "last_message",
  "includeMessageHistory": true,

  "toolNames": [
    "read_files",
    "write_file",
    "code_search",
    "spawn_agents",
    "end_turn"
  ],
  "spawnableAgents": ["CodebuffAI/researcher"],

  "promptSchema": {
    "prompt": {
      "type": "string",
      "description": "What documentation to create or update"
    }
  },

  "systemPrompt": {
    "path": "./doc-writer-system.md"
  },
  "userInputPrompt": "Create comprehensive documentation based on the user's request. Research existing code first.",
  "agentStepPrompt": "Continue working on the documentation. Use end_turn when complete."
}
```
