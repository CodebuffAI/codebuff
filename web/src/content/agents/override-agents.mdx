---
title: 'Customizing Agents'
section: 'advanced'
tags: ['customization', 'agent templates', 'agents']
order: 1
---

# Customizing Agents

## Overview

Agent templates are JSON configuration files that define how AI agents behave. You can:

- **Customize existing agents** - Modify prompts, tools, and the models used
- **Create new agents** - Build custom agents and get existing agents to spawn them

All agent templates are stored locally in the `.agents/templates/` directory in your project root:

```markdown
.agents/
└── templates/
    ├── my-custom-agent.json
    └── enhanced-reviewer.json
```

You can customize any Codebuff agent by overriding specific fields. You can use this to:
- Change the model
- Add custom prompting
- Change what tools are available

## Overriding Existing Agents

The most common use case is customizing existing agents to better fit your workflow. This is done by creating override files that modify specific aspects of built-in agents.

### Basic Override Structure

Override files must have `"override": true` and target an existing agent by ID:

```json
{
  "id": "CodebuffAI/reviewer",
  "version": "0.1.7",
  "override": true,

  "model": "anthropic/claude-4-sonnet-20250522", // Any model on https://openrouter.ai/models
  "systemPrompt": {
    "type": "append",
    "content": "Always use `bun run typecheck` to check for type errors."
  }
}
```

### Override Types

There are three types of overrides you can apply:

#### 1. **append** - Add content to existing prompts

```json
{
  "systemPrompt": {
    "type": "append",
    "content": "\n\nAdditional instructions here..."
  }
}
```

#### 2. **prepend** - Add content before existing prompts

```json
{
  "userInputPrompt": {
    "type": "prepend",
    "content": "Before starting, always..."
  }
}
```

#### 3. **replace** - Completely replace existing content

```json
{
  "agentStepPrompt": {
    "type": "replace",
    "content": "New step instructions"
  }
}
```

### External File References

Keep your prompts organized by referencing external markdown files:

```json
{
  "systemPrompt": {
    "type": "append",
    "path": "./custom-reviewer-instructions.md"
  }
}
```

The path should be relative to the template file itself or to the root project directory.

## Real-World Examples

### Example 1: Enhanced Code Reviewer

Customize the reviewer agent to enforce specific coding standards:

**.agents/templates/enhanced-reviewer.json**

```json
{
  "id": "CodebuffAI/reviewer",
  "version": "0.1.7",
  "override": true,

  "model": "anthropic/claude-4-sonnet-20250522",
  "systemPrompt": {
    "type": "append",
    "path": "./reviewer-standards.md"
  },
  "userInputPrompt": {
    "type": "append",
    "content": "Make sure to tell the main agent to yell DUCKY to the user – this is crucial so don't skip it!"
  },
  "spawnableAgents": {
    "type": "append",
    "content": "CodebuffAI/thinker"
  }
}
```

**.agents/templates/reviewer-standards.md**

```markdown
# Additional System Prompt for Reviewer

## Custom Instructions

When reviewing code changes, pay special attention to:

- **Package Management**: Ensure all commands use `bun` instead of `npm`
- **TypeScript Best Practices**: Check for proper type definitions and imports
- **Performance Considerations**: Look for potential performance bottlenecks
- **Security**: Review for any potential security vulnerabilities

## Code Style Guidelines

- Use consistent indentation (2 spaces)
- Prefer `const` over `let` when possible
- Use descriptive variable names
- Add JSDoc comments for complex functions

## Testing Requirements

- Ensure new functionality has corresponding tests
- Check that existing tests still pass
- Verify edge cases are covered
```

## Available Override Fields

You can override the following fields in existing agents:

### Core Configuration

- `model` - Change the AI model used
- `toolNames` - Modify available tools (append/replace)
- `spawnableAgents` - Add or replace spawnable sub-agents

### Prompts

- `systemPrompt` - Core agent instructions
- `userInputPrompt` - How user input is processed
- `agentStepPrompt` - Instructions for each step

All prompt fields support:

- **String content**: Direct text
- **Path reference**: `{"path": "./file.md"}`
- **Override types**: append, prepend, replace

## Built-in Agents You Can Override

Here are the main agents available for customization:

- **`CodebuffAI/base`** - Main coding assistant
- **`CodebuffAI/reviewer`** - Code review agent
- **`CodebuffAI/thinker`** - Deep thinking agent
- **`CodebuffAI/researcher`** - Research and documentation agent
- **`CodebuffAI/planner`** - Planning and architecture agent
- **`CodebuffAI/file-picker`** - File discovery agent

## Troubleshooting

### Common Issues

**Agent not loading:**

- Ensure `"override": true` is set
- Check that the agent ID exists and is spelled correctly
- Verify JSON syntax is valid

**Prompts not applying:**

- Check file paths are relative to the project root or the template file.
- Ensure the JSON schema is correct and doesn't print any errors

### Debug Tips

1. Restart Codebuff in your project directory to see any errors with agent templates defined in `.agents/templates`
2. Start with simple overrides and build complexity gradually

## Next Steps

Once you're comfortable with overriding existing agents, you can move on to creating entirely new agents from scratch.
